import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
/**
 * @shortdesc
 * Angular 2 service to inject to use Facebook's SDK
 * @description
 * You only need to inject this service in your application if you aren't using [`FacebookModule`](../facebook-module).
 * @usage
 * ```typescript
 * import { FacebookService, InitParams } from 'ngx-facebook-sdk';
 *
 * constructor(private fb: FacebookService) {
 *
 *   const params: InitParams = {
 *
 *   };
 *
 *   fb.init(params);
 *
 * }
 * ```
 */
import * as ɵngcc0 from '@angular/core';
var FacebookService = /** @class */ (function () {
    function FacebookService() {
    }
    /**
     * This method is used to initialize and setup the SDK.
     * @param params {InitParams} Initialization parameters
     * @returns {Promise<any>}
     */
    FacebookService.prototype.init = function (params) {
        try {
            return Promise.resolve(FB.init(params));
        }
        catch (e) {
            return Promise.reject(e);
        }
    };
    /**
     * This method lets you make calls to the Graph API
     * @usage
     * ```typescript
     * this.fb.api('somepath')
     *   .then(res => console.log(res))
     *   .catch(e => console.log(e));
     * ```
     * @param path {string} The Graph API endpoint path that you want to call.
     * @param [method=get] {string} The HTTP method that you want to use for the API request.
     * @param [params] {Object} An object consisting of any parameters that you want to pass into your Graph API call.
     * @returns {Promise<any>}
     */
    FacebookService.prototype.api = function (path, method, params) {
        if (method === void 0) { method = 'get'; }
        if (params === void 0) { params = {}; }
        return new Promise(function (resolve, reject) {
            try {
                FB.api(path, method, params, function (response) {
                    if (!response) {
                        reject();
                    }
                    else if (response.error) {
                        reject(response.error);
                    }
                    else {
                        resolve(response);
                    }
                });
            }
            catch (e) {
                reject(e);
            }
        });
    };
    /**
     * This method is used to trigger different forms of Facebook created UI dialogs.
     * These dialogs include:
     * - Share dialog
     * - Login dialog
     * - Add page tab dialog
     * - Requests dialog
     * - Send dialog
     * - Payments dialog
     * - Go Live dialog
     * @param params {UIParams} A collection of parameters that control which dialog is loaded, and relevant settings.
     * @returns {Promise<UIResponse>}
     */
    FacebookService.prototype.ui = function (params) {
        return new Promise(function (resolve, reject) {
            try {
                FB.ui(params, function (response) {
                    if (!response)
                        reject();
                    else if (response.error)
                        reject(response.error);
                    else
                        resolve(response);
                });
            }
            catch (e) {
                reject(e);
            }
        });
    };
    /**
     * This method allows you to determine if a user is logged in to Facebook and has authenticated your app.
     * @param [forceFreshResponse=false] {boolean} Force a fresh response.
     * @returns {Promise<LoginStatus>}
     */
    FacebookService.prototype.getLoginStatus = function (forceFreshResponse) {
        return new Promise(function (resolve, reject) {
            try {
                FB.getLoginStatus(function (response) {
                    if (!response) {
                        reject();
                    }
                    else {
                        resolve(response);
                    }
                }, forceFreshResponse);
            }
            catch (e) {
                reject(e);
            }
        });
    };
    /**
     * Login the user
     * @usage
     * ```typescript
     * // login without options
     * this.fb.login()
     *   .then((response: LoginResponse) => console.log('Logged in', response))
     *   .catch(e => console.error('Error logging in'));
     *
     * // login with options
     * const options: LoginOptions = {
     *   scope: 'public_profile,user_friends,email,pages_show_list',
     *   return_scopes: true,
     *   enable_profile_selector: true
     * };
     * this.fb.login(options)
     *   .then(...)
     *   .catch(...);
     * ```
     * @param [options] {LoginOptions} Login options
     * @returns {Promise<LoginResponse>} returns a promise that resolves with [LoginResponse](../login-response) object, or rejects with an error
     */
    FacebookService.prototype.login = function (options) {
        return new Promise(function (resolve, reject) {
            try {
                FB.login(function (response) {
                    if (response.authResponse) {
                        resolve(response);
                    }
                    else {
                        reject();
                    }
                }, options);
            }
            catch (e) {
                reject(e);
            }
        });
    };
    /**
     * Logout the user
     * @usage
     * ```typescript
     * this.fb.logout().then(() => console.log('Logged out!'));
     * ```
     * @returns {Promise<any>} returns a promise that resolves when the user is logged out
     */
    FacebookService.prototype.logout = function () {
        return new Promise(function (resolve, reject) {
            try {
                FB.logout(function (response) {
                    resolve(response);
                });
            }
            catch (e) {
                reject(e);
            }
        });
    };
    /**
     * This synchronous function returns back the current authResponse.
     * @usage
     * ```typescript
     * import { AuthResponse, FacebookService } from 'ngx-facebook-sdk';
     *
     * ...
     *
     * const authResponse: AuthResponse = this.fb.getAuthResponse();
     * ```
     * @returns {AuthResponse} returns an [AuthResponse](../auth-response) object
     */
    FacebookService.prototype.getAuthResponse = function () {
        try {
            return FB.getAuthResponse();
        }
        catch (e) {
            console.error('ngx-facebook-sdk: ', e);
        }
    };
    FacebookService.ɵprov = i0.ɵɵdefineInjectable({ factory: function FacebookService_Factory() { return new FacebookService(); }, token: FacebookService, providedIn: "root" });
FacebookService.ɵfac = function FacebookService_Factory(t) { return new (t || FacebookService)(); };
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(FacebookService, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return []; }, null); })();
    return FacebookService;
}());
export { FacebookService };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFjZWJvb2suanMiLCJzb3VyY2VzIjpbIm5nOi9uZ3gtZmFjZWJvb2svcHJvdmlkZXJzL2ZhY2Vib29rLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDO0FBZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUlIO0FBR2EsSUFIYjtBQUE2QixLQXNMNUI7QUFDRCxJQXJMRTtBQUNGO0FBQ0U7QUFDRTtBQUVKLE9BREs7QUFDTCxJQUFFLDhCQUFJLEdBQUosVUFBSyxNQUFrQjtBQUFJLFFBQ3pCLElBQUk7QUFDUixZQUFNLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDOUMsU0FBSztBQUFDLFFBQUEsT0FBTyxDQUFDLEVBQUU7QUFDaEIsWUFBTSxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDL0IsU0FBSztBQUNMLElBQUUsQ0FBQztBQUVILElBQUU7QUFDRjtBQUNFO0FBQ0U7QUFDRTtBQUNFO0FBQ0U7QUFFUDtBQUFXO0FBQ0U7QUFDRTtBQUNFO0FBRUosT0FEWDtBQUNMLElBQUUsNkJBQUcsR0FBSCxVQUFJLElBQVksRUFBRSxNQUF5QixFQUFFLE1BQWdCO0FBQUksUUFBL0MsdUJBQUEsRUFBQSxjQUF5QjtBQUFJLFFBQUYsdUJBQUEsRUFBQSxXQUFnQjtBQUFJLFFBQy9ELE9BQU8sSUFBSSxPQUFPLENBQU0sVUFBQyxPQUFPLEVBQUUsTUFBTTtBQUFJLFlBRTFDLElBQUk7QUFDVixnQkFBUSxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFVBQUMsUUFBYTtBQUFJLG9CQUM3QyxJQUFJ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LFNBdkxhLGVBQWU7QUFFNUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBBdXRoUmVzcG9uc2UgfSBmcm9tICcuLi9tb2RlbHMvYXV0aC1yZXNwb25zZSc7XG5pbXBvcnQgeyBJbml0UGFyYW1zIH0gZnJvbSAnLi4vbW9kZWxzL2luaXQtcGFyYW1zJztcbmltcG9ydCB7IExvZ2luT3B0aW9ucyB9IGZyb20gJy4uL21vZGVscy9sb2dpbi1vcHRpb25zJztcbmltcG9ydCB7IExvZ2luUmVzcG9uc2UgfSBmcm9tICcuLi9tb2RlbHMvbG9naW4tcmVzcG9uc2UnO1xuaW1wb3J0IHsgTG9naW5TdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvbG9naW4tc3RhdHVzJztcbmltcG9ydCB7IFVJUGFyYW1zIH0gZnJvbSAnLi4vbW9kZWxzL3VpLXBhcmFtcyc7XG5pbXBvcnQgeyBVSVJlc3BvbnNlIH0gZnJvbSAnLi4vbW9kZWxzL3VpLXJlc3BvbnNlJztcblxuZGVjbGFyZSB2YXIgRkI6IGFueTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydCB0eXBlIEFwaU1ldGhvZCA9ICdnZXQnIHwgJ3Bvc3QnIHwgJ2RlbGV0ZSc7XG5cbi8qKlxuICogQHNob3J0ZGVzY1xuICogQW5ndWxhciAyIHNlcnZpY2UgdG8gaW5qZWN0IHRvIHVzZSBGYWNlYm9vaydzIFNES1xuICogQGRlc2NyaXB0aW9uXG4gKiBZb3Ugb25seSBuZWVkIHRvIGluamVjdCB0aGlzIHNlcnZpY2UgaW4geW91ciBhcHBsaWNhdGlvbiBpZiB5b3UgYXJlbid0IHVzaW5nIFtgRmFjZWJvb2tNb2R1bGVgXSguLi9mYWNlYm9vay1tb2R1bGUpLlxuICogQHVzYWdlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQgeyBGYWNlYm9va1NlcnZpY2UsIEluaXRQYXJhbXMgfSBmcm9tICduZ3gtZmFjZWJvb2stc2RrJztcbiAqXG4gKiBjb25zdHJ1Y3Rvcihwcml2YXRlIGZiOiBGYWNlYm9va1NlcnZpY2UpIHtcbiAqXG4gKiAgIGNvbnN0IHBhcmFtczogSW5pdFBhcmFtcyA9IHtcbiAqXG4gKiAgIH07XG4gKlxuICogICBmYi5pbml0KHBhcmFtcyk7XG4gKlxuICogfVxuICogYGBgXG4gKi9cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIEZhY2Vib29rU2VydmljZSB7XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gaW5pdGlhbGl6ZSBhbmQgc2V0dXAgdGhlIFNESy5cbiAgICogQHBhcmFtIHBhcmFtcyB7SW5pdFBhcmFtc30gSW5pdGlhbGl6YXRpb24gcGFyYW1ldGVyc1xuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxuICAgKi9cbiAgaW5pdChwYXJhbXM6IEluaXRQYXJhbXMpOiBQcm9taXNlPGFueT4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKEZCLmluaXQocGFyYW1zKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCBsZXRzIHlvdSBtYWtlIGNhbGxzIHRvIHRoZSBHcmFwaCBBUElcbiAgICogQHVzYWdlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogdGhpcy5mYi5hcGkoJ3NvbWVwYXRoJylcbiAgICogICAudGhlbihyZXMgPT4gY29uc29sZS5sb2cocmVzKSlcbiAgICogICAuY2F0Y2goZSA9PiBjb25zb2xlLmxvZyhlKSk7XG4gICAqIGBgYFxuICAgKiBAcGFyYW0gcGF0aCB7c3RyaW5nfSBUaGUgR3JhcGggQVBJIGVuZHBvaW50IHBhdGggdGhhdCB5b3Ugd2FudCB0byBjYWxsLlxuICAgKiBAcGFyYW0gW21ldGhvZD1nZXRdIHtzdHJpbmd9IFRoZSBIVFRQIG1ldGhvZCB0aGF0IHlvdSB3YW50IHRvIHVzZSBmb3IgdGhlIEFQSSByZXF1ZXN0LlxuICAgKiBAcGFyYW0gW3BhcmFtc10ge09iamVjdH0gQW4gb2JqZWN0IGNvbnNpc3Rpbmcgb2YgYW55IHBhcmFtZXRlcnMgdGhhdCB5b3Ugd2FudCB0byBwYXNzIGludG8geW91ciBHcmFwaCBBUEkgY2FsbC5cbiAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn1cbiAgICovXG4gIGFwaShwYXRoOiBzdHJpbmcsIG1ldGhvZDogQXBpTWV0aG9kID0gJ2dldCcsIHBhcmFtczogYW55ID0ge30pOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgRkIuYXBpKHBhdGgsIG1ldGhvZCwgcGFyYW1zLCAocmVzcG9uc2U6IGFueSkgPT4ge1xuICAgICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAgIHJlamVjdChyZXNwb25zZS5lcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlamVjdChlKTtcbiAgICAgIH1cblxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gdHJpZ2dlciBkaWZmZXJlbnQgZm9ybXMgb2YgRmFjZWJvb2sgY3JlYXRlZCBVSSBkaWFsb2dzLlxuICAgKiBUaGVzZSBkaWFsb2dzIGluY2x1ZGU6XG4gICAqIC0gU2hhcmUgZGlhbG9nXG4gICAqIC0gTG9naW4gZGlhbG9nXG4gICAqIC0gQWRkIHBhZ2UgdGFiIGRpYWxvZ1xuICAgKiAtIFJlcXVlc3RzIGRpYWxvZ1xuICAgKiAtIFNlbmQgZGlhbG9nXG4gICAqIC0gUGF5bWVudHMgZGlhbG9nXG4gICAqIC0gR28gTGl2ZSBkaWFsb2dcbiAgICogQHBhcmFtIHBhcmFtcyB7VUlQYXJhbXN9IEEgY29sbGVjdGlvbiBvZiBwYXJhbWV0ZXJzIHRoYXQgY29udHJvbCB3aGljaCBkaWFsb2cgaXMgbG9hZGVkLCBhbmQgcmVsZXZhbnQgc2V0dGluZ3MuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPFVJUmVzcG9uc2U+fVxuICAgKi9cbiAgdWkocGFyYW1zOiBVSVBhcmFtcyk6IFByb21pc2U8VUlSZXNwb25zZT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgRkIudWkocGFyYW1zLCAocmVzcG9uc2U6IGFueSkgPT4ge1xuICAgICAgICAgIGlmKCFyZXNwb25zZSkgcmVqZWN0KCk7XG4gICAgICAgICAgZWxzZSBpZihyZXNwb25zZS5lcnJvcikgcmVqZWN0KHJlc3BvbnNlLmVycm9yKTtcbiAgICAgICAgICBlbHNlIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgfVxuXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBtZXRob2QgYWxsb3dzIHlvdSB0byBkZXRlcm1pbmUgaWYgYSB1c2VyIGlzIGxvZ2dlZCBpbiB0byBGYWNlYm9vayBhbmQgaGFzIGF1dGhlbnRpY2F0ZWQgeW91ciBhcHAuXG4gICAqIEBwYXJhbSBbZm9yY2VGcmVzaFJlc3BvbnNlPWZhbHNlXSB7Ym9vbGVhbn0gRm9yY2UgYSBmcmVzaCByZXNwb25zZS5cbiAgICogQHJldHVybnMge1Byb21pc2U8TG9naW5TdGF0dXM+fVxuICAgKi9cbiAgZ2V0TG9naW5TdGF0dXMoZm9yY2VGcmVzaFJlc3BvbnNlPzogYm9vbGVhbik6IFByb21pc2U8TG9naW5TdGF0dXM+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8TG9naW5TdGF0dXM+KChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgRkIuZ2V0TG9naW5TdGF0dXMoKHJlc3BvbnNlOiBMb2dpblN0YXR1cykgPT4ge1xuICAgICAgICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZvcmNlRnJlc2hSZXNwb25zZSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlamVjdChlKTtcbiAgICAgIH1cblxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIExvZ2luIHRoZSB1c2VyXG4gICAqIEB1c2FnZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIC8vIGxvZ2luIHdpdGhvdXQgb3B0aW9uc1xuICAgKiB0aGlzLmZiLmxvZ2luKClcbiAgICogICAudGhlbigocmVzcG9uc2U6IExvZ2luUmVzcG9uc2UpID0+IGNvbnNvbGUubG9nKCdMb2dnZWQgaW4nLCByZXNwb25zZSkpXG4gICAqICAgLmNhdGNoKGUgPT4gY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBpbicpKTtcbiAgICpcbiAgICogLy8gbG9naW4gd2l0aCBvcHRpb25zXG4gICAqIGNvbnN0IG9wdGlvbnM6IExvZ2luT3B0aW9ucyA9IHtcbiAgICogICBzY29wZTogJ3B1YmxpY19wcm9maWxlLHVzZXJfZnJpZW5kcyxlbWFpbCxwYWdlc19zaG93X2xpc3QnLFxuICAgKiAgIHJldHVybl9zY29wZXM6IHRydWUsXG4gICAqICAgZW5hYmxlX3Byb2ZpbGVfc2VsZWN0b3I6IHRydWVcbiAgICogfTtcbiAgICogdGhpcy5mYi5sb2dpbihvcHRpb25zKVxuICAgKiAgIC50aGVuKC4uLilcbiAgICogICAuY2F0Y2goLi4uKTtcbiAgICogYGBgXG4gICAqIEBwYXJhbSBbb3B0aW9uc10ge0xvZ2luT3B0aW9uc30gTG9naW4gb3B0aW9uc1xuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxMb2dpblJlc3BvbnNlPn0gcmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIFtMb2dpblJlc3BvbnNlXSguLi9sb2dpbi1yZXNwb25zZSkgb2JqZWN0LCBvciByZWplY3RzIHdpdGggYW4gZXJyb3JcbiAgICovXG4gIGxvZ2luKG9wdGlvbnM/OiBMb2dpbk9wdGlvbnMpOiBQcm9taXNlPExvZ2luUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8TG9naW5SZXNwb25zZT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG4gICAgICB0cnkge1xuICAgICAgICBGQi5sb2dpbigocmVzcG9uc2U6IExvZ2luUmVzcG9uc2UpID0+IHtcbiAgICAgICAgICBpZiAocmVzcG9uc2UuYXV0aFJlc3BvbnNlKSB7XG4gICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgb3B0aW9ucyk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJlamVjdChlKTtcbiAgICAgIH1cblxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIExvZ291dCB0aGUgdXNlclxuICAgKiBAdXNhZ2VcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiB0aGlzLmZiLmxvZ291dCgpLnRoZW4oKCkgPT4gY29uc29sZS5sb2coJ0xvZ2dlZCBvdXQhJykpO1xuICAgKiBgYGBcbiAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0gcmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSB1c2VyIGlzIGxvZ2dlZCBvdXRcbiAgICovXG4gIGxvZ291dCgpOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgRkIubG9nb3V0KChyZXNwb25zZTogYW55KSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG5cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIHN5bmNocm9ub3VzIGZ1bmN0aW9uIHJldHVybnMgYmFjayB0aGUgY3VycmVudCBhdXRoUmVzcG9uc2UuXG4gICAqIEB1c2FnZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGltcG9ydCB7IEF1dGhSZXNwb25zZSwgRmFjZWJvb2tTZXJ2aWNlIH0gZnJvbSAnbmd4LWZhY2Vib29rLXNkayc7XG4gICAqXG4gICAqIC4uLlxuICAgKlxuICAgKiBjb25zdCBhdXRoUmVzcG9uc2U6IEF1dGhSZXNwb25zZSA9IHRoaXMuZmIuZ2V0QXV0aFJlc3BvbnNlKCk7XG4gICAqIGBgYFxuICAgKiBAcmV0dXJucyB7QXV0aFJlc3BvbnNlfSByZXR1cm5zIGFuIFtBdXRoUmVzcG9uc2VdKC4uL2F1dGgtcmVzcG9uc2UpIG9iamVjdFxuICAgKi9cbiAgZ2V0QXV0aFJlc3BvbnNlKCk6IEF1dGhSZXNwb25zZSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiA8QXV0aFJlc3BvbnNlPkZCLmdldEF1dGhSZXNwb25zZSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ25neC1mYWNlYm9vay1zZGs6ICcsIGUpO1xuICAgIH1cbiAgfVxuXG59XG4iXX0=